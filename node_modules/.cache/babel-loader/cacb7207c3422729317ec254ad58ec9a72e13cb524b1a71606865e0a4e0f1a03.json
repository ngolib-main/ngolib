{"ast":null,"code":"/*\r\n * -- PROTECTED ROUTE --\r\n * This file helps restricting access to certain routes\r\n * according to user's authentication status\r\n *\r\n */import React,{useEffect,useState}from'react';import{Navigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";function ProtectedRoute(_ref){let{children,allowedRoles}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{fetch(\"/api/auth/me\",{credentials:\"include\"}).then(res=>res.ok?res.json():null).then(data=>{setUser(data);setLoading(false);}).catch(()=>{setUser(null);setLoading(false);});},[]);if(loading)return null;// Or show a spinner\nif(!user)return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});if(!allowedRoles.includes(user.type)){// Redirect to the correct route for their role\nif(user.type===\"admin\")return/*#__PURE__*/_jsx(Navigate,{to:\"/admin\",replace:true});if(user.type===\"NGO\")return/*#__PURE__*/_jsx(Navigate,{to:\"/profile\",replace:true});if(user.type===\"user\")return/*#__PURE__*/_jsx(Navigate,{to:\"/user\",replace:true});return/*#__PURE__*/_jsx(Navigate,{to:\"/home\",replace:true});}return children;}export default ProtectedRoute;","map":{"version":3,"names":["React","useEffect","useState","Navigate","jsx","_jsx","ProtectedRoute","_ref","children","allowedRoles","user","setUser","loading","setLoading","fetch","credentials","then","res","ok","json","data","catch","to","replace","includes","type"],"sources":["/home/javi/Server/src/components/reusable/ProtectedRoute.js"],"sourcesContent":["/*\r\n * -- PROTECTED ROUTE --\r\n * This file helps restricting access to certain routes\r\n * according to user's authentication status\r\n *\r\n */\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\n\r\nfunction ProtectedRoute({ children, allowedRoles }) {\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetch(\"/api/auth/me\", {\r\n            credentials: \"include\"\r\n        })\r\n            .then(res => res.ok ? res.json() : null)\r\n            .then(data => {\r\n                setUser(data);\r\n                setLoading(false);\r\n            })\r\n            .catch(() => {\r\n                setUser(null);\r\n                setLoading(false);\r\n            });\r\n    }, []);\r\n\r\n    if (loading) return null; // Or show a spinner\r\n\r\n    if (!user) return <Navigate to=\"/login\" replace />;\r\n    if (!allowedRoles.includes(user.type)) {\r\n        // Redirect to the correct route for their role\r\n        if (user.type === \"admin\") return <Navigate to=\"/admin\" replace />;\r\n        if (user.type === \"NGO\") return <Navigate to=\"/profile\" replace />;\r\n        if (user.type === \"user\") return <Navigate to=\"/user\" replace />;\r\n        return <Navigate to=\"/home\" replace />;\r\n    }\r\n\r\n    return children;\r\n}\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA,GAEA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,QAAQ,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE5C,QAAS,CAAAC,cAAcA,CAAAC,IAAA,CAA6B,IAA5B,CAAEC,QAAQ,CAAEC,YAAa,CAAC,CAAAF,IAAA,CAC9C,KAAM,CAACG,IAAI,CAAEC,OAAO,CAAC,CAAGT,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACU,OAAO,CAAEC,UAAU,CAAC,CAAGX,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACZa,KAAK,CAAC,cAAc,CAAE,CAClBC,WAAW,CAAE,SACjB,CAAC,CAAC,CACGC,IAAI,CAACC,GAAG,EAAIA,GAAG,CAACC,EAAE,CAAGD,GAAG,CAACE,IAAI,CAAC,CAAC,CAAG,IAAI,CAAC,CACvCH,IAAI,CAACI,IAAI,EAAI,CACVT,OAAO,CAACS,IAAI,CAAC,CACbP,UAAU,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CACDQ,KAAK,CAAC,IAAM,CACTV,OAAO,CAAC,IAAI,CAAC,CACbE,UAAU,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CACV,CAAC,CAAE,EAAE,CAAC,CAEN,GAAID,OAAO,CAAE,MAAO,KAAI,CAAE;AAE1B,GAAI,CAACF,IAAI,CAAE,mBAAOL,IAAA,CAACF,QAAQ,EAACmB,EAAE,CAAC,QAAQ,CAACC,OAAO,MAAE,CAAC,CAClD,GAAI,CAACd,YAAY,CAACe,QAAQ,CAACd,IAAI,CAACe,IAAI,CAAC,CAAE,CACnC;AACA,GAAIf,IAAI,CAACe,IAAI,GAAK,OAAO,CAAE,mBAAOpB,IAAA,CAACF,QAAQ,EAACmB,EAAE,CAAC,QAAQ,CAACC,OAAO,MAAE,CAAC,CAClE,GAAIb,IAAI,CAACe,IAAI,GAAK,KAAK,CAAE,mBAAOpB,IAAA,CAACF,QAAQ,EAACmB,EAAE,CAAC,UAAU,CAACC,OAAO,MAAE,CAAC,CAClE,GAAIb,IAAI,CAACe,IAAI,GAAK,MAAM,CAAE,mBAAOpB,IAAA,CAACF,QAAQ,EAACmB,EAAE,CAAC,OAAO,CAACC,OAAO,MAAE,CAAC,CAChE,mBAAOlB,IAAA,CAACF,QAAQ,EAACmB,EAAE,CAAC,OAAO,CAACC,OAAO,MAAE,CAAC,CAC1C,CAEA,MAAO,CAAAf,QAAQ,CACnB,CAEA,cAAe,CAAAF,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}