{"ast":null,"code":"import React,{useState}from'react';import styles from'../../style/page/donate.module.css';import{useParams}from\"react-router-dom\";import Header from'../reusable/Header';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Donate=()=>{const{id:ngo_id}=useParams();const[cardNumber,setCardNumber]=useState('');const[expiry,setExpiry]=useState('');const[cvv,setCvv]=useState('');const[amount,setAmount]=useState('50');const[status,setStatus]=useState('');const handlePayment=async e=>{e.preventDefault();if(!cardNumber||cardNumber.replace(/\\s/g,'').length!==16||!expiry||!isValidExpiry(expiry)||!cvv||cvv.length!==3||!amount||parseFloat(amount)<1){setStatus('Please fill all fields correctly');return;}try{const response=await fetch('/api/payment',{method:'POST',credentials:\"include\",headers:{'Content-Type':'application/json'},body:JSON.stringify({ngo_id:parseInt(ngo_id),amount:parseFloat(amount)})});console.log('fetch /api/payment status:',response.status);const text=await response.text();console.log('fetch /api/payment body:',text);if(response.ok){setStatus('Donation successfully sent');}else{setStatus('Something went wrong, make sure you are logged in');}}catch(error){console.error(error);setStatus('Something went wrong, try again later');}};return/*#__PURE__*/_jsxs(\"div\",{className:styles.page,children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Payment\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handlePayment,className:styles.form,children:[/*#__PURE__*/_jsxs(\"label\",{className:styles.label,children:[\"Card Number:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:cardNumber,onChange:e=>{var _rawValue$match;setStatus('');const rawValue=e.target.value.replace(/\\D/g,\"\");const formatted=((_rawValue$match=rawValue.match(/.{1,4}/g))===null||_rawValue$match===void 0?void 0:_rawValue$match.join(\" \").trim())||\"\";setCardNumber(formatted);},placeholder:\"1234 5678 9012 3456\",className:styles.input,maxLength:19})]}),/*#__PURE__*/_jsxs(\"label\",{className:styles.label,children:[\"Card Expiration:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:expiry,onChange:e=>{setStatus('');let input=e.target.value.replace(/\\D/g,'');if(input.length>=3){input=input.slice(0,2)+'/'+input.slice(2,4);}setExpiry(input);},placeholder:\"MM/YY\",className:styles.input,maxLength:5})]}),/*#__PURE__*/_jsxs(\"label\",{className:styles.label,children:[\"Security Code:\",/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:cvv,onChange:e=>{setStatus('');setCvv(e.target.value);},placeholder:\"123\",className:styles.input,maxLength:\"3\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:styles.label,children:[\"Amount, \\u20AC:\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:amount,onChange:e=>{setStatus('');setAmount(e.target.value);},className:styles.input,min:\"1\",required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:styles.button,children:\"Proceed\"})]}),status&&/*#__PURE__*/_jsx(\"p\",{className:styles.status,children:status})]})]});};const isValidExpiry=expiry=>{if(!/^\\d{2}\\/\\d{2}$/.test(expiry))return false;const[monthStr,yearStr]=expiry.split('/');const month=parseInt(monthStr,10);const year=parseInt('20'+yearStr,10);// convert \"25\" → 2025\nif(month<1||month>12)return false;const now=new Date();const expiryDate=new Date(year,month);// first day of the next month\nreturn expiryDate>now;};export default Donate;","map":{"version":3,"names":["React","useState","styles","useParams","Header","jsx","_jsx","jsxs","_jsxs","Donate","id","ngo_id","cardNumber","setCardNumber","expiry","setExpiry","cvv","setCvv","amount","setAmount","status","setStatus","handlePayment","e","preventDefault","replace","length","isValidExpiry","parseFloat","response","fetch","method","credentials","headers","body","JSON","stringify","parseInt","console","log","text","ok","error","className","page","children","container","onSubmit","form","label","type","value","onChange","_rawValue$match","rawValue","target","formatted","match","join","trim","placeholder","input","maxLength","slice","min","required","button","test","monthStr","yearStr","split","month","year","now","Date","expiryDate"],"sources":["/home/javi/Server/src/components/donate/donate.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport styles from '../../style/page/donate.module.css';\r\nimport {useParams} from \"react-router-dom\";\r\nimport Header from '../reusable/Header';\r\n\r\nconst Donate = () => {\r\n    const { id: ngo_id } = useParams();\r\n    const [cardNumber, setCardNumber] = useState('');\r\n    const [expiry, setExpiry] = useState('');\r\n    const [cvv, setCvv] = useState('');\r\n    const [amount, setAmount] = useState('50');\r\n    const [status, setStatus] = useState('');\r\n    const handlePayment = async (e) => {\r\n\r\n        e.preventDefault();\r\n        if (\r\n            !cardNumber || cardNumber.replace(/\\s/g, '').length !== 16 ||\r\n            !expiry || !isValidExpiry(expiry) ||\r\n            !cvv || cvv.length !== 3 ||\r\n            !amount || parseFloat(amount) < 1\r\n        ) {\r\n            setStatus('Please fill all fields correctly');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await fetch('/api/payment', {\r\n                method: 'POST',\r\n                credentials: \"include\",\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    ngo_id: parseInt(ngo_id),\r\n                    amount: parseFloat(amount),\r\n                }),\r\n            });\r\n\r\n            console.log('fetch /api/payment status:', response.status);\r\n            const text = await response.text();\r\n            console.log('fetch /api/payment body:', text);\r\n\r\n            if (response.ok) {\r\n                setStatus('Donation successfully sent');\r\n            } else {\r\n                setStatus('Something went wrong, make sure you are logged in');\r\n            }\r\n        } catch (error) {\r\n            console.error(error);\r\n            setStatus('Something went wrong, try again later');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.page}>\r\n            <Header />\r\n        <div className={styles.container}>\r\n            <h2>Payment</h2>\r\n            <form onSubmit={handlePayment} className={styles.form}>\r\n                <label className={styles.label}>\r\n                    Card Number:\r\n                    <input\r\n                        type=\"text\"\r\n                        value={cardNumber}\r\n                        onChange={(e) => {\r\n                            setStatus('');\r\n                            const rawValue = e.target.value.replace(/\\D/g, \"\");\r\n                            const formatted = rawValue\r\n                                .match(/.{1,4}/g)\r\n                                ?.join(\" \")\r\n                                .trim() || \"\";\r\n                            setCardNumber(formatted);\r\n                        }}\r\n                        placeholder=\"1234 5678 9012 3456\"\r\n                        className={styles.input}\r\n                        maxLength={19}\r\n                    />\r\n\r\n                </label>\r\n                <label className={styles.label}>\r\n                    Card Expiration:\r\n                    <input\r\n                        type=\"text\"\r\n                        value={expiry}\r\n                        onChange={(e) => {\r\n                            setStatus('');\r\n                            let input = e.target.value.replace(/\\D/g, '');\r\n                            if (input.length >= 3) {\r\n                                input = input.slice(0, 2) + '/' + input.slice(2, 4);\r\n                            }\r\n                            setExpiry(input);\r\n                        }}\r\n                        placeholder=\"MM/YY\"\r\n                        className={styles.input}\r\n                        maxLength={5}\r\n                    />\r\n\r\n                </label>\r\n                <label className={styles.label}>\r\n                    Security Code:\r\n                    <input\r\n                        type=\"password\"\r\n                        value={cvv}\r\n                        onChange={(e) => {\r\n                            setStatus('');\r\n                            setCvv(e.target.value);}\r\n                        }\r\n                        placeholder=\"123\"\r\n                        className={styles.input}\r\n                        maxLength=\"3\"\r\n                    />\r\n                </label>\r\n                <label className={styles.label}>\r\n                    Amount, €:\r\n                    <input\r\n                        type=\"number\"\r\n                        value={amount}\r\n                        onChange={(e) => {\r\n                            setStatus('');\r\n                            setAmount(e.target.value);}\r\n                        }\r\n                        className={styles.input}\r\n                        min=\"1\"\r\n                        required\r\n                    />\r\n                </label>\r\n                <button type=\"submit\" className={styles.button}>Proceed</button>\r\n            </form>\r\n            {status && <p className={styles.status}>{status}</p>}\r\n        </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst isValidExpiry = (expiry) => {\r\n    if (!/^\\d{2}\\/\\d{2}$/.test(expiry)) return false;\r\n\r\n    const [monthStr, yearStr] = expiry.split('/');\r\n    const month = parseInt(monthStr, 10);\r\n    const year = parseInt('20' + yearStr, 10); // convert \"25\" → 2025\r\n\r\n    if (month < 1 || month > 12) return false;\r\n\r\n    const now = new Date();\r\n    const expiryDate = new Date(year, month); // first day of the next month\r\n\r\n    return expiryDate > now;\r\n};\r\n\r\nexport default Donate;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}